<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Results</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <center>
          <img src="images/prompt-beta.png" alt="PROMpT logo">
          </center>
        </header>
        <hr>

        <section id="solo_analysis">
          <h1>Data Portal</h1>
          <h2>Pie charts abundance by sample</h2>

          <form name='form1' action='./results.php'>
            <h3>Data Origin:</h3>
            <input type="radio" name="origin" value="SEQ" onclick=submit() selected >Barcode Sequencing
            <input type="radio" name="origin" value="MIC" onclick=submit() >Microscopy
          </form>
          <form name='form2' action='./results.php'>
            <h3>Select a Site:</h3>
            <input type="hidden" name="origin" value="<?php if(isset($_GET['origin'])) echo $_GET['origin']; ?>" />
            <?php
            $origin = $_GET['origin'];

            $sites = glob("analyses/pie/$origin/*");

            $col1 = 0;

            foreach ($sites as $site){
                $site = preg_replace("/analyses\/pie\/$origin\//i", '', $site);
                print "<input name=\"site\" type=\"radio\" value=\"$site\"  onclick=\"submit()\">$site\n";
                $col1++;
                if ( is_int ($col1 / 8))
                   print "<br>\n";
                   $col1++;
                }
                ?>
          </form>

          <?php
          foreach($_GET as $key=>$value){
                $$key = $value;
                $site_code = $value;
                }
                print "<h2>site: $site_code</h2>";

          $arr = array('class', 'family', 'genus', 'species', 'refseq');
          print "<br><select id='setit' name='url'>
          <option value=\"\">Choose Taxonomy level...</option>";
          foreach ($arr as $value){
                print "<option value='analyses/pie/$origin/$site_code/$value.html'>$value</option>\n";
                }
        print "<input type='button' value='go' onclick=\"window.open(setit.options[setit.selectedIndex].value)\">";
        ?>
        </section>

        <hr>

        <section id="comp_analysis">

          <h2>Comparative sample analysis</h2>
          <form name='form2' target="_blank" action='/cgi-bin/prompt/make-csv.cgi' method="GET">
          <h3> Choose Taxa Level:</h3>

          <?php
          foreach ($arr as $value){
                print "<input name=\"taxa\" type=\"radio\" value=\"$value\">$value\n";
                }
          print "<br>";

          echo "<p>";
          $MIC_opts = glob("analyses/abun/MIC/*");
          $col2 = 1;

          print "<h3>MIC</h3>\n";
          foreach ($MIC_opts as $heat_opt){
              $heat_opt = preg_replace("/analyses\/abun\/MIC\//i", '', $heat_opt);
              print "<input name='MIC_$heat_opt' type='checkbox' value='$heat_opt' >$heat_opt";
              if ( is_int ($col2 / 8))
                  print "<br>\n";
                  $col2++;
                  
         }
              $SEQ_opts = glob("analyses/abun/SEQ/*");
              $col2 = 1;

          print "<h3>NGS</h3>\n";
        
          foreach ($SEQ_opts as $heat_opt){
              $heat_opt = preg_replace("/analyses\/abun\/SEQ\//i", '', $heat_opt);
              print "<input name='SEQ_$heat_opt' type='checkbox' value='$heat_opt' >$heat_opt";
              if ( is_int ($col2 / 8))
                print "<br>\n";
                $col2++;

        }
        echo "</p>";
        echo "<input type='submit' value='Collate Data' onclick=\"submit\">";
        echo "</form>";

        echo "<input type='button' value='Generate Heatmap' onclick=\"window.open('r_call.php'); window.open('tmp/current.pdf')\">";
        echo "<input type='button' value='Download data' onclick=\"window.open('tmp/compound_abun.csv')\">";
        echo "<br>n.b. If multiple pdf's are open, press refresh to view newest.<br>\n";
?>
 
        </section>

        <footer>
          PROMpT is maintained by <a href="https://github.com/passdan">passdan</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

                  <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-55861033-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

      </div>
    </div>
  </body>
</html>
